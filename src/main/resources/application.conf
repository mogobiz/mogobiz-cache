# Please refer to the minimal configuration to understand the meaning of all properties.
# Starting from the minimal configuration, some information have been extracted.
# First of all, the different server has been extracted, thus we can referenced them in the different input/output properties
# In this file, two chained jobs have been created as well. One for the api and one for jahia.
# This allows a separated run for each of them.
# The same result could be done by launching the application with two configuration file.
# Furthermore, most of the URI start the same way. This data has been extracted to a property, which can be referenced.
# All optional properties are filled in this file.
mogobiz.cache {
  server {
    es {
      protocol: "http"
      #host: "192.168.1.229"
      host: "es.ebiznext.com"
      port: 80
      maxClient: 10
    },
    api {
      protocol: "http"
      host: "mogobiz.ebiznext.com"
      port: 12000
      maxClient: 10
    },
    jahia {
      protocol: "http"
      host: "mogobiz.ebiznext.com"
      port: 12000
      maxClient: 10
    }
  },
  store: "acmesport"
  uri {
    api {
      prefix: "/api/store/"${mogobiz.cache.store}
      process: [
        {
          input: {
            index: ${mogobiz.cache.store}
            type: "product"
            fields: ["id"]
            encodeFields: true
            scroll: "5m"
            size: 100
            server: ${mogobiz.cache.server.es}
          },
          output: {
            uri: ${mogobiz.cache.uri.api.prefix}"/products/{0}"
            headers:{
              "x-custom-header-1" : "my-header"
              "x-custom-header-2" : "my-header"
            }
            server: ${mogobiz.cache.server.api}
          }
        },
        {
          output: {
            uri: ${mogobiz.cache.uri.api.prefix}"/products"
            headers:{
              "x-custom-header" : "my-header"
            }
            server: ${mogobiz.cache.server.api}
          }
        },
        {
          output: {
            uri: ${mogobiz.cache.uri.api.prefix}"/promotions"
            headers:{
              "x-custom-header" : "my-header"
            }
            server: ${mogobiz.cache.server.api}
          }
        },
        {
          input: {
            index: ${mogobiz.cache.store}
            type: "brand"
            fields: ["id"]
            encodeFields: true
            scroll: "5m"
            size: 100
            server: ${mogobiz.cache.server.es}
          },
          output: {
            uri: ${mogobiz.cache.uri.api.prefix}"/brands?brandId={0}"
            headers:{
              "x-custom-header" : "my-header"
            }
            server: ${mogobiz.cache.server.api}
          }
        },
        {
          output: {
            uri: ${mogobiz.cache.uri.api.prefix}"/brands"
            headers:{
              "x-custom-header" : "my-header"
            }
            server: ${mogobiz.cache.server.api}
          }
        },
        {
          input: {
            index: ${mogobiz.cache.store}
            type: "category"
            fields: "path"
            encodeFields: true,
            scroll: "5m"
            size: 100
            server: ${mogobiz.cache.server.es}
          },
          output: {
            uri: ${mogobiz.cache.uri.api.prefix}"/categories?categoryPath={0}"
            headers:{
              "x-custom-header" : "my-header"
            }
            server: ${mogobiz.cache.server.api}
          }
        },
        {
          input: {
            index: ${mogobiz.cache.store}
            type: "category"
            fields: ["parentId"]
            encodeFields: true
            scroll: "5m"
            size: 100
            server: ${mogobiz.cache.server.es}
          },
          output: {
            uri: ${mogobiz.cache.uri.api.prefix}"/categories?parentId={0}"
            headers:{
              "x-custom-header" : "my-header"
            }
            server: ${mogobiz.cache.server.api}
          }
        },
        {
          output: {
            uri: ${mogobiz.cache.uri.api.prefix}"/categories"
            headers:{
              "x-custom-header" : "my-header"
            }
            server: ${mogobiz.cache.server.api}
          }
        }
      ]
    },
    jahia {
      prefix: "/en"
      store: "/JCF_store-acmesport"
      process: [
        {
          output: {
            uri: ${mogobiz.cache.uri.jahia.prefix}"/home.html"
            headers:{
              "x-custom-header" : "my-header"
            }
            server: ${mogobiz.cache.server.jahia}
          }
        },
        {
          input: {
            index: ${mogobiz.cache.store}
            type: "product"
            fields: ["id"]
            encodeFields: true
            scroll: "5m"
            size: 100
            server: ${mogobiz.cache.server.es}
          },
          output: {
            uri: ${mogobiz.cache.uri.jahia.prefix}${mogobiz.cache.uri.jahia.store}"/products/{0}.html"
            headers:{
              "x-custom-header" : "my-header"
            }
            server: ${mogobiz.cache.server.jahia}
          }
        },
        {
          output: {
            uri: ${mogobiz.cache.uri.jahia.prefix}"/home/new-products.html"
            headers:{
              "x-custom-header" : "my-header"
            }
            server: ${mogobiz.cache.server.jahia}
          }
        },
        {
          output: {
            uri: ${mogobiz.cache.uri.jahia.prefix}"/home/all-promotions.html"
            headers:{
              "x-custom-header" : "my-header"
            }
            server: ${mogobiz.cache.server.jahia}
          }
        },
        {
          input: {
            index: ${mogobiz.cache.store}
            type: "brand"
            fields: ["name"]
            encodeFields: true
            scroll: "5m"
            size: 100
            server: ${mogobiz.cache.server.es}
          },
          output: {
            uri: ${mogobiz.cache.uri.jahia.prefix}${mogobiz.cache.uri.jahia.store}"/brands/{0}.html"
            headers:{
              "x-custom-header" : "my-header"
            }
            server: ${mogobiz.cache.server.jahia}
          }
        },
        {
          output: {
            uri: ${mogobiz.cache.uri.jahia.prefix}"/home/brands.html"
            headers:{
              "x-custom-header" : "my-header"
            }
            server: ${mogobiz.cache.server.jahia}
          }
        },
        {
          input: {
            index: ${mogobiz.cache.store}
            type: "category"
            fields: "path"
            encodeFields: [false]
            scroll: "5m"
            size: 100
            server: ${mogobiz.cache.server.es}
          },
          output: {
            uri: ${mogobiz.cache.uri.jahia.prefix}${mogobiz.cache.uri.jahia.store}"/categories/{0}.html"
            headers:{
              "x-custom-header" : "my-header"
            }
            server: ${mogobiz.cache.server.jahia}
          }
        },
        {
          output: {
            uri: ${mogobiz.cache.uri.jahia.prefix}"/home/categories.html"
            headers:{
              "x-custom-header" : "my-header"
            }
            server: ${mogobiz.cache.server.jahia}
          }
        }
      ]
    }
  }
}